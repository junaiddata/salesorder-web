{% load humanize %}
<tbody>
  <!-- Totals Row -->
  <tr class="totals-row">
    <td class="sticky-col" style="left: 0; font-weight: 700; background: var(--primary-light);">TOTAL</td>
    <td class="sticky-col" style="left: 150px; font-weight: 700; background: var(--primary-light);"></td>
    {% for totals in totals_list %}
      <td class="text-right totals-cell" style="font-weight: 700; background: var(--primary-light);">{{ totals.total_sales|default:0|floatformat:2|intcomma }}</td>
      {% if is_admin %}<td class="text-right totals-cell" style="font-weight: 700; background: var(--primary-light);">{{ totals.total_gp|default:0|floatformat:2|intcomma }}</td>{% endif %}
      {% if is_admin %}<td class="text-right totals-cell" style="font-weight: 700; background: var(--primary-light);">{{ totals.total_gp_percent|default:0|floatformat:2 }}%</td>{% endif %}
      <td class="text-right totals-cell" style="font-weight: 700; background: var(--primary-light);">-</td>
      <td class="text-right totals-cell totals-last-col" style="font-weight: 700; background: var(--primary-light);">-</td>
    {% endfor %}
  </tr>
  {% for item in items %}
  <tr>
    <td class="sticky-col" style="left: 0;">
      <div class="item-code">{{ item.item_code|default:"â€”" }}</div>
      {% if item.upc_code %}
      <div class="item-upc">UPC: {{ item.upc_code }}</div>
      {% endif %}
    </td>
    <td class="sticky-col item-description" style="left: 150px;">{{ item.item_description|default:"Unknown" }}</td>
    {% for year_data in item.year_list %}
      <td class="text-right">{{ year_data.total_sales|default:0|floatformat:2|intcomma }}</td>
      {% if is_admin %}<td class="text-right">{{ year_data.total_gp|default:0|floatformat:2|intcomma }}</td>{% endif %}
      {% if is_admin %}<td class="text-right">{{ year_data.gp_percent|default:0|floatformat:2 }}%</td>{% endif %}
      <td class="text-right">{{ year_data.total_quantity|default:0|floatformat:0|intcomma }}</td>
      <td class="text-right">{{ year_data.avg_rate|default:0|floatformat:2|intcomma }}</td>
    {% endfor %}
  </tr>
  {% empty %}
  <tr>
    <td colspan="{% widthratio years|length 1 4 %}" class="empty-state">
      <i class="fas fa-inbox"></i>
      <p>No item data available</p>
    </td>
  </tr>
  {% endfor %}
</tbody>
